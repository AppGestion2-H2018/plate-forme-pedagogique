<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css"
	  xmlns="http://www.w3.org/1999/html">

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Popper JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>
<h2>Mes groupes </h2>
<form class="deleteGroupe" id="deleteGroupe" (submit)="deleteGroupe($event)">
	<div class="form-group row">
				<label class="col-md-2 required">
					Supprimer :
				</label>
				<input type=text placeholder="Numéro id" class="form-control col-md-10" id="id" name="id">
	</div>
	<input type="submit" value="Supprimer">
</form>

<h2>Mes groupes</h2>
<ul class="groupe">
	<li *ngFor="let groupe of groupes"
		[class.selected]="groupe === selectedGroupe"
		(click)="onSelect(groupe)">
		<span class="badge">Groupe : {{groupe.nom}}</span>
	</li>
</ul>

<div *ngIf="selectedGroupe">
	<h2>{{ selectedGroupe.nom }} Info du groupe</h2>
	<div><span>ID: </span>{{selectedGroupe._id}}</div>
	<div><span>Nom du groupe: </span>{{selectedGroupe.nom}}</div>
	<div><span>Super admin: </span>{{selectedGroupe.super_admins}}</div>
	<div><span>Admin: </span>{{selectedGroupe.admins}}</div>
	<div><span>Programmes: </span>{{selectedGroupe.programmes}}</div>
	<div><span>Groupe: </span>{{selectedGroupe.groupes}}</div>
	<div><span>Type: </span>{{selectedGroupe.types}}</div>
	<div><span>Utilisateur: </span>{{selectedGroupe.utilisateurs}}</div>
	<div><span>Blacklist: </span>{{selectedGroupe.blacklist}}</div>
	<div><button type="button"(click)="deleteGroupe(selectedGroupe)">Supprimer</button></div>
	<div><button type="button" (click)="updateGroupe()" >Modifier</button></div>
</div>
<!--<ul>
    <li *ngFor="let groupe of groupes; let i = index">
        {{i}} {{groupe.nom}}
    </li>
</ul>-->

<!--<ul>
    <li *ngFor="let classe of classes; let i = index">
        {{i}} {{classe.nom}}
    </li>
</ul>-->
<div class="example-container mat-elevation-z8">
	<mat-table #tableGroupes [dataSource]="groupes" matSort>

		<ng-container matColumnDef="Description">
			<mat-header-cell *matHeaderCellDef mat-sort-header> Description </mat-header-cell>
			<mat-cell *matCellDef="let groupe">
				<form #groupeFormEdition="ngForm" id="groupeFormEdition" (ngSubmit)="groupeFormEdition.form.valid && onEdit(groupeFormEdition)">
					<mat-form-field *ngIf="(selectedGroupe && selectedGroupe === groupe);else editNom;" class="input-full-width">
						<input name="selectedGroupeNom"
							   id="selectedGroupeNom"
							   [(ngModel)]="selectedGroupe.nom"
							   matInput required minlength="2"
							   maxlength="50" name="nomEdition"
							   #nomEdition="ngModel"
							   placeholder="Nom du groupe">
						<mat-error *ngIf="nomEdition.invalid && (nomEdition.dirty || nomEdition.touched) &&
                        nomEdition.hasError('required')">Le nom est obligatoire.</mat-error>
						<mat-error *ngIf="nomEdition.invalid && (nomEdition.dirty || nomEdition.touched) &&
                        nomEdition.hasError('minlength')">Le nom doit contenir au moins 2 caractères.</mat-error>
						<mat-error *ngIf="nomEdition.invalid && (nomEdition.dirty || nomEdition.touched) &&
                        nomEdition.hasError('maxlength')">Le nom doit contenir au maximum 50 caractères.</mat-error>
					</mat-form-field>

					<mat-form-field *ngIf="(selectedGroupe && selectedGroupe === groupe);else editDescription;" class="example-full-width">
						<textarea
								name="selectedGroupeDescription"
								id="selectedGroupeDescription"
								[(ngModel)]="selectedGroupe.description"
								#descriptionEdition="ngModel"
								matInput placeholder="Description du groupe"></textarea>
					</mat-form-field>

					<mat-form-field *ngIf="(selectedGroupe && selectedGroupe === groupe);else editFin;">
					<input name="selectedGroupeFin"
					placeholder="Date de la fin du groupe"
					matInput [matDatepicker]="myDatepicker"
					[(ngModel)]="selectedGroupe.date_fin" (click)="onEdit(groupe)" >
					<mat-datepicker-toggle matSuffix [for]="myDatepicker"></mat-datepicker-toggle>
					<mat-datepicker #myDatepicker></mat-datepicker>
					</mat-form-field>

					<br>
					<mat-radio-group *ngIf="(selectedGroupe && selectedGroupe === groupe);else editActif;">
						<input type="radio" name="inactif" [(ngModel)]="selectedGroupe.actif" value="false" >
						Inactif
						<input type="radio" name="actif" [(ngModel)]="selectedGroupe.actif" value="true">
						Actif
					</mat-radio-group>
					<br>
					<mat-radio-group *ngIf="(selectedGroupe && selectedGroupe === groupe);else editPublique;">
						<input type="radio" name="prive" [(ngModel)]="selectedGroupe.est_publique" value="false">
						Privé
						<input type="radio" name="publique" [(ngModel)]="selectedGroupe.est_publique" value="true">
						Publique
					</mat-radio-group>
					<br>
					<mat-radio-group *ngIf="(selectedGroupe && selectedGroupe === groupe);else editCommenter;">
						<input type="radio" name="nonCommenter" [(ngModel)]="selectedGroupe.commenter" value="false">
						Commentaire non autorisé
						<input type="radio" name="commenter" [(ngModel)]="selectedGroupe.commenter" value="true">
						Commentaire autorisé
					</mat-radio-group>


					<mat-form-field *ngIf="(selectedGroupe && selectedGroupe === groupe);else editClasse;" >
					<mat-select [(ngModel)]="selectedGroupe.classes" name="classe">
						<mat-option *ngFor="let classe of classes" [value]="classe._id" >
							{{ classe._id }}
						</mat-option>
					</mat-select>
					</mat-form-field>

				</form>
				<ng-template #editNom>
					<h2 id="nom" (click)="onSelected(groupe)">{{groupe.nom}}</h2>
				</ng-template>

				<ng-template #editDescription>
					<span id="description" (click)="onSelected(groupe)"> Description : {{groupe.description}}  </span>
					<p></p>
				</ng-template>

				<ng-template #editFin>
					<span (click)="onSelected(groupe)"> Date échéance : {{groupe.date_fin | date:'dd/MM/yyyy'}}</span>
				</ng-template>

				<ng-template #editActif>
					<span  id="actif"(click)="onSelected(groupe)"> Actif : {{groupe.actif}}</span>
				</ng-template>

				<ng-template #editPublique>
				<span  id="publique" (click)="onSelected(groupe)"> Publique : {{groupe.est_publique}}</span>
				</ng-template>

				<ng-template #editCommenter>
					<span  id="commenter" (click)="onSelected(groupe)"> Commentaire autorisé : {{groupe.commenter}}</span>
				</ng-template>

				<ng-template #editClasse>
					<span  id="classe" (click)="onSelected(groupe)"> Classe : {{groupe.classes}}</span>
				</ng-template>

			</mat-cell>
		</ng-container>

		<ng-container matColumnDef="actions">
			<mat-header-cell *matHeaderCellDef>Actions</mat-header-cell>
			<mat-cell *matCellDef="let groupe" class="boutonsAction">
				<button *ngIf="(selectedGroupe && selectedGroupe === groupe);else editButton;" color="primary" form="groupeFormEdition" mat-button><i class="material-icons">done</i></button>
				<ng-template #editButton>
					<form (ngSubmit)="onSelected(groupe)">
						<button mat-button><i class="material-icons">edit</i></button>
					</form>
				</ng-template>
				<form (ngSubmit)="onDelete(groupe)">
					<button mat-button ><i class="material-icons">delete</i></button>
				</form>
				<form>
					<button mat-button ><i class="material-icons">people</i></button>
				</form>
				<form>
					<button mat-button ><i class="material-icons">ajout</i></button>
				</form>
			</mat-cell>
		</ng-container>

		<mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
		<mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>

	</mat-table>
</div>


